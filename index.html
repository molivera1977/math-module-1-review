<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Math Module 1 Review</title>
  <style>
    body {
      font-family: "Comic Sans MS", "Comic Neue", Arial, sans-serif;
      background: #f0f8ff;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }
    header {
      background: linear-gradient(90deg, #0074d9, #39c0ed);
      color: white;
      padding: 1.2rem;
      text-align: center;
      font-size: 1.6rem;
      font-weight: bold;
      letter-spacing: 1px;
    }
    .container {
      max-width: 800px;
      margin: 2rem auto;
      background: white;
      padding: 2rem;
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      position: relative;
      z-index: 1;
    }
    .hidden { display: none; }
    button {
      background: #0074d9;
      color: white;
      border: none;
      padding: 10px 15px;
      margin: 8px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      transition: background 0.2s;
    }
    button:hover { background: #005fa3; }
    .feedback {
      margin-top: 1rem;
      font-weight: bold;
      font-size: 1.2rem;
    }
    .correct { color: #28a745; }
    .incorrect { color: #dc3545; }
    .score {
      font-size: 1.3rem;
      margin-top: 1rem;
      font-weight: bold;
    }
    .message {
      font-size: 1.1rem;
      margin-top: 0.5rem;
      font-style: italic;
    }
    .progress {
      font-size: 1rem;
      margin-bottom: 0.3rem;
      font-weight: bold;
    }
    .progress-bar-container {
      background: #e0e0e0;
      border-radius: 10px;
      overflow: hidden;
      height: 18px;
      margin-bottom: 1rem;
    }
    .progress-bar {
      background: linear-gradient(90deg, #39c0ed, #28a745);
      height: 100%;
      width: 0%;
      transition: width 0.4s ease;
    }
    label { display: block; margin: 6px 0; cursor: pointer; }
    .answer-btn.correct::after { content: " ‚úÖ"; color: #28a745; font-weight: bold; }
    .answer-btn.incorrect::after { content: " ‚ùå"; color: #dc3545; font-weight: bold; }
    #confetti-canvas {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      z-index: 999;
    }
  </style>
</head>
<body>
  <header>
    üìò Math Module 1 Review
  </header>
  <canvas id="confetti-canvas"></canvas>
  <div class="container">
    <div id="start-screen">
      <h2>Welcome! Pick a Test Form:</h2>
      <button onclick="startTest('A')">Form A</button>
      <button onclick="startTest('B')">Form B</button>
    </div>

    <div id="quiz-screen" class="hidden">
      <p class="progress" id="progress"></p>
      <div class="progress-bar-container">
        <div class="progress-bar" id="progress-bar"></div>
      </div>
      <h2 id="question-text"></h2>
      <div id="answers"></div>
      <div class="feedback" id="feedback"></div>
      <button id="submit-btn" class="hidden" onclick="submitMulti()">Submit</button>
      <button id="next-btn" class="hidden" onclick="nextQuestion()">Next Question ‚û°Ô∏è</button>
    </div>

    <div id="end-screen" class="hidden">
      <h2>üéâ Test Complete!</h2>
      <p class="score" id="final-score"></p>
      <p class="score" id="percent-score"></p>
      <p class="message" id="performance-message"></p>
      <button onclick="restart()">üîÑ Try Again</button>
    </div>
  </div>

  <!-- Audio sounds -->
  <audio id="ding-sound" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>
  <audio id="buzz-sound" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>
<script>
const tests = {
  A: [
    {q:"How many times greater is the value of the digit 9 in 90,000 than the value of the digit 9 in 9,000?", options:["10","100","10,000","100,000"], answer:"10"},
    {q:"What is 364,872 rounded to the nearest thousand?", options:["360,000","364,000","365,000","400,000"], answer:"365,000"},
    {q:"What is 500,000 + 9,000 + 300 + 8 written in word form?", options:["five hundred nine thousand, three hundred eighty","five hundred nine thousand, three hundred eight","fifty-nine thousand, three hundred eighty","fifty-nine thousand, three hundred eight"], answer:"five hundred nine thousand, three hundred eight"},
    {q:"In which number is the value of the digit 7 ten times the value of the digit 7 in 948,736?", options:["349,867","498,782","726,093","817,654"], answer:"817,654"},
    {q:"Which number will make both comparisons true? 37,481 < ? < 38,697", options:["37,399","37,454","38,121","38,733"], answer:"38,121"},
    {q:"A number rounded to the nearest hundred thousand is 600,000. The same number rounded to the nearest ten thousand is 650,000. Which of these could be the number?", options:["642,871","648,329","654,732","661,428"], answer:"648,329"},
    {q:"Select all the correct ways to regroup and rename the number 720,000.", options:["720 tens","7,200 hundreds","720 thousands","72 ten thousands","72 hundred thousands"], answer:["7,200 hundreds","720 thousands","72 ten thousands"], multi:true},
    {q:"True or False: 9,426 < 9,237", options:["True","False"], answer:"False"},
    {q:"True or False: 8,000 + 90 = 8,000 + 9", options:["True","False"], answer:"False"},
    {q:"True or False: four hundred seventy-eight > four hundred fifty-nine", options:["True","False"], answer:"True"},
    {q:"What is 36,142 rounded to the nearest thousand?", options:["36,000","37,000","36,100","36,200"], answer:"36,000"},
    {q:"Regroup and rename: 25,000 = ? hundreds", options:["25","250","2,500","2500"], answer:"250"},
    {q:"What is 400,000 + 20,000 + 80 + 5 in standard form?", options:["420,805","420,085","400,285","420,580"], answer:"420,085"},
    {q:"Max rolls four number cubes (3, 5, 1, 4). What is the GREATEST possible 4-digit number?", options:["5431","5314","5430","5413"], answer:"5431"},
    {q:"Max rolls four number cubes (3, 5, 1, 4). What is the LEAST possible 4-digit number?", options:["1345","1354","1435","1543"], answer:"1345"},
    {q:"For the number 2,488, how many times greater is the value of the digit 8 in the tens place than the digit 8 in the ones place?", options:["1","5","10","100"], answer:"10"},
    {q:"A baseball team sold tickets: June 234,887; July 229,531; August 256,832. Order from GREATEST to LEAST.", options:["256,832, 234,887, 229,531","234,887, 229,531, 256,832","229,531, 234,887, 256,832","256,832, 229,531, 234,887"], answer:"256,832, 234,887, 229,531"},
    {q:"Compare June (234,887) and August (256,832).", options:["<",">","="], answer:"<"}
  ],
  B: [
    {q:"How many times greater is the value of the digit 2 in 20,000 than the value of the digit 2 in 2,000?", options:["1","10","100","1,000"], answer:"10"},
    {q:"What is 21,842 rounded to the nearest hundred?", options:["21,800","21,840","21,900","22,000"], answer:"21,800"},
    {q:"What is 90,000 + 2,000 + 500 + 60 written in word form?", options:["nine hundred two thousand, five hundred sixty","ninety-two thousand, five hundred sixty","nine hundred two thousand, fifty-six","ninety-two thousand, fifty-six"], answer:"ninety-two thousand, five hundred sixty"},
    {q:"In which number is the value of the digit 6 ten times the value of the digit 6 in 251,687?", options:["164,834","429,615","786,129","812,567"], answer:"786,129"},
    {q:"Which number will make both comparisons true? 42,572 < ? < 43,895", options:["42,567","42,981","43,914","44,632"], answer:"42,981"},
    {q:"A number rounded to the nearest hundred thousand is 800,000. The same number rounded to the nearest ten thousand is 850,000. Which of these could be the number?", options:["834,659","849,135","852,563","873,142"], answer:"849,135"},
    {q:"Select all the correct ways to regroup and rename the number 340,000.", options:["34,000 tens","3,400 hundreds","3,400 thousands","34,000 hundreds","34 ten thousands"], answer:["3,400 hundreds","34 ten thousands"], multi:true},
    {q:"True or False: 2,090 = 2,900", options:["True","False"], answer:"False"},
    {q:"True or False: 3,000 + 600 + 2 < 3,000 + 700 + 3", options:["True","False"], answer:"True"},
    {q:"True or False: six thousand, fifty-one > six thousand, fifteen", options:["True","False"], answer:"True"},
    {q:"What is 204,875 rounded to the nearest hundred?", options:["204,800","204,840","204,900","205,000"], answer:"204,900"},
    {q:"Regroup and rename: 3,700 = ? tens", options:["37","370","3,700","3700"], answer:"370"},
    {q:"What is 200,000 + 9,000 + 600 + 40 + 8 in standard form?", options:["209,068","209,486","209,648","200,968"], answer:"209,648"},
    {q:"Emily used the digits 6, 3, and 7 to make the GREATEST number possible. What number did she make?", options:["763","736","673","637"], answer:"763"},
    {q:"Jayson used the digits 6, 3, and 7 to make the LEAST number possible. What number did he make?", options:["637","367","736","673"], answer:"367"},
    {q:"For the number 5,512, how many times greater is the value of the digit 5 in the thousands place than in the hundreds place?", options:["5","10","100","1,000"], answer:"10"},
    {q:"Water park tickets: June 193,148; July 174,453; August 147,056. Order from LEAST to GREATEST.", options:["147,056, 174,453, 193,148","193,148, 174,453, 147,056","174,453, 147,056, 193,148","147,056, 193,148, 174,453"], answer:"147,056, 174,453, 193,148"},
    {q:"Compare June (193,148) and August (147,056).", options:["<",">","="], answer:">"}
  ]
};
let currentTest = [];
let currentIndex = 0;
let score = 0;

function shuffle(array) {
  return array.sort(() => Math.random() - 0.5);
}

function playSound(type) {
  if (type === "correct") {
    document.getElementById("ding-sound").play();
  } else {
    document.getElementById("buzz-sound").play();
  }
}

function startTest(form) {
  currentTest = JSON.parse(JSON.stringify(tests[form]));
  currentTest = shuffle(currentTest);
  currentTest.forEach(q => {
    q.options = shuffle(q.options);
  });
  currentIndex = 0;
  score = 0;
  document.getElementById("start-screen").classList.add("hidden");
  document.getElementById("quiz-screen").classList.remove("hidden");
  showQuestion();
}

function showQuestion() {
  const qObj = currentTest[currentIndex];
  document.getElementById("progress").innerText = `Question ${currentIndex + 1} of ${currentTest.length}`;
  const percent = ((currentIndex) / currentTest.length) * 100;
  document.getElementById("progress-bar").style.width = percent + "%";

  document.getElementById("question-text").innerText = qObj.q;
  const answersDiv = document.getElementById("answers");
  answersDiv.innerHTML = "";

  if (qObj.multi) {
    qObj.options.forEach(opt => {
      const label = document.createElement("label");
      const box = document.createElement("input");
      box.type = "checkbox";
      box.value = opt;
      label.appendChild(box);
      label.appendChild(document.createTextNode(" " + opt));
      answersDiv.appendChild(label);
    });
    document.getElementById("submit-btn").classList.remove("hidden");
    document.getElementById("next-btn").classList.add("hidden");
  } else {
    qObj.options.forEach(opt => {
      const btn = document.createElement("button");
      btn.innerText = opt;
      btn.className = "answer-btn";
      btn.onclick = () => checkAnswer(opt, qObj.answer, btn);
      answersDiv.appendChild(btn);
    });
    document.getElementById("submit-btn").classList.add("hidden");
  }
  document.getElementById("feedback").innerText = "";
}

function checkAnswer(selected, correct, btn) {
  if (selected === correct) {
    document.getElementById("feedback").innerText = "‚úÖ Correct!";
    document.getElementById("feedback").className = "feedback correct";
    btn.classList.add("correct");
    score++;
    playSound("correct");
  } else {
    document.getElementById("feedback").innerText = "‚ùå Incorrect. Correct answer: " + correct;
    document.getElementById("feedback").className = "feedback incorrect";
    btn.classList.add("incorrect");
    playSound("incorrect");
  }
  Array.from(document.getElementById("answers").children).forEach(b => b.disabled = true);
  document.getElementById("next-btn").classList.remove("hidden");
}

function submitMulti() {
  const qObj = currentTest[currentIndex];
  const checkboxes = document.querySelectorAll("#answers input[type=checkbox]");
  let selected = [];
  checkboxes.forEach(cb => { if (cb.checked) selected.push(cb.value); });
  const correctSet = new Set(qObj.answer);
  const selectedSet = new Set(selected);

  if (selectedSet.size === correctSet.size && [...selectedSet].every(x => correctSet.has(x))) {
    document.getElementById("feedback").innerText = "‚úÖ Correct!";
    document.getElementById("feedback").className = "feedback correct";
    score++;
    playSound("correct");
  } else {
    document.getElementById("feedback").innerText = "‚ùå Incorrect. Correct answers: " + qObj.answer.join(", ");
    document.getElementById("feedback").className = "feedback incorrect";
    playSound("incorrect");
  }
  checkboxes.forEach(cb => cb.disabled = true);
  document.getElementById("submit-btn").classList.add("hidden");
  document.getElementById("next-btn").classList.remove("hidden");
}

function nextQuestion() {
  currentIndex++;
  if (currentIndex < currentTest.length) {
    showQuestion();
  } else {
    endTest();
  }
}

function endTest() {
  document.getElementById("quiz-screen").classList.add("hidden");
  document.getElementById("end-screen").classList.remove("hidden");
  const percent = Math.round((score / currentTest.length) * 100);
  document.getElementById("progress-bar").style.width = "100%";
  document.getElementById("final-score").innerText = `You scored ${score} out of ${currentTest.length}.`;
  document.getElementById("percent-score").innerText = `That‚Äôs ${percent}%.`;

  let message = "";
  if (percent === 100) {
    message = "üåü Excellent work! Perfect score!";
  } else if (percent >= 80) {
    message = "üëç Great job! You really know this material.";
  } else if (percent >= 60) {
    message = "üëå Not bad! Keep practicing to improve.";
  } else {
    message = "üí° Keep trying! Review the lessons and practice again.";
  }
  document.getElementById("performance-message").innerText = message;

  launchConfetti();
}

// üéâ Confetti effect
function launchConfetti() {
  const duration = 3 * 1000;
  const end = Date.now() + duration;

  (function frame() {
    confetti({ particleCount: 4, angle: 60, spread: 55, origin: { x: 0 } });
    confetti({ particleCount: 4, angle: 120, spread: 55, origin: { x: 1 } });
    if (Date.now() < end) {
      requestAnimationFrame(frame);
    }
  })();
}

function restart() {
  document.getElementById("end-screen").classList.add("hidden");
  document.getElementById("start-screen").classList.remove("hidden");
  document.getElementById("progress-bar").style.width = "0%";
}
</script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</body>
</html>
